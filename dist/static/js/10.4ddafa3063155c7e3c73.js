webpackJsonp([10],{"5dbc":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a={name:"add-dish",data:function(){return{form:{name:"",price:null,file:null,description:"",restaurantId:null,restaurantName:""},rules:{name:[{required:!0,message:"名字不能为空",trigger:"blur"}],restaurantId:[{required:!0,type:"number",message:"请选择餐厅",trigger:"blur"}],price:[{required:!0,type:"number",message:"请输入正确的价格"}]},restaurantList:[]}},methods:{handleUpload:function(e){return this.form.file=e,!1},handleSubmit:function(e){var t=this;this.$refs[e].validate(function(e){if(e){if(null===t.form.file)return void t.$Message.error("请上传图片！");var r=new FormData;r.append("file",t.form.file),r.append("name",t.form.name),r.append("price",t.form.price),r.append("description",t.form.description),r.append("restaurantId",t.form.restaurantId),r.append("restaurantName",t.getRestaurantName(t.form.restaurantId));t.$Spin.show(),t.$http.post("/dish-manager/add",r,{headers:{"Content-Type":"multipart/form-data"}}).then(function(e){t.$Spin.hide(),0===e.data.code?t.$Modal.success({title:"添加成功",content:"是否继续添加？",onOk:function(){t.$router.push("/manager-dish/add")},onCancel:function(){t.$router.push("/manager-dish")}}):3===e.data.code?(t.$Message.error("请登录菜管!"),t.$router.push("/manager-dish/adminLogin")):t.$Message.error("提交失败！")},function(e){t.$Spin.hide(),t.$Message.error("提交失败！"),console.log(e)})}else t.$Message.error("提交失败！")})},handleReset:function(e){this.$refs[e].resetFields()},getRestaurantName:function(e){for(var t=0;t<this.restaurantList.length;t++)if(this.restaurantList[t].id===e)return this.restaurantList[t].name}},created:function(){var e=this;this.$http.get("/restaurant/get/all").then(function(t){e.restaurantList=t.data.data},function(e){console.log(e)})}},n={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("Row",{staticClass:"code-row-bg",attrs:{type:"flex",justify:"center"}},[r("Col",{attrs:{xs:22,sm:18,md:14,lg:10}},[r("h4",{staticClass:"title"},[e._v("添加菜品")]),r("Form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-position":"top"}},[r("FormItem",{attrs:{label:"菜名",prop:"name"}},[r("Input",{attrs:{placeholder:"请输入菜名"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),r("FormItem",{attrs:{label:"餐厅",prop:"restaurantId"}},[r("Select",{attrs:{filterable:"filterable"},model:{value:e.form.restaurantId,callback:function(t){e.$set(e.form,"restaurantId",t)},expression:"form.restaurantId"}},e._l(e.restaurantList,function(t,a){return r("Option",{key:a,attrs:{value:t.id}},[e._v(e._s(t.name))])}))],1),r("FormItem",{attrs:{label:"价格",prop:"price"}},[r("Input",{attrs:{placeholder:"请输入价格",number:"number"},model:{value:e.form.price,callback:function(t){e.$set(e.form,"price",t)},expression:"form.price"}})],1),r("FormItem",{attrs:{label:"描述",prop:"description"}},[r("Input",{attrs:{placeholder:"请输入描述，让大家更快了解菜品",type:"textarea",autosize:{minRows:3,maxRows:3}},model:{value:e.form.description,callback:function(t){e.$set(e.form,"description",t)},expression:"form.description"}})],1),r("FormItem",{attrs:{label:"上传图片（必传）"}},[r("Upload",{attrs:{"before-upload":e.handleUpload,action:"",format:["jpg","jpeg","png"],"max-size":2048}},[r("Button",{attrs:{icon:"ios-cloud-upload-outline"}},[e._v("上传图片")]),null!==this.form.file?r("div",[e._v("已选择文件："+e._s(this.form.file.name)+"，点击重新选择")]):e._e()],1)],1),r("FormItem",[r("Button",{attrs:{type:"primary"},on:{click:function(t){e.handleSubmit("form")}}},[e._v("提交")]),r("Button",{staticStyle:{float:"right"},on:{click:function(t){e.handleReset("form")}}},[e._v("重填")])],1)],1)],1)],1)},staticRenderFns:[]};var o=r("VU/8")(a,n,!1,function(e){r("THD1")},"data-v-7ebb725c",null);t.default=o.exports},THD1:function(e,t){}});
//# sourceMappingURL=10.4ddafa3063155c7e3c73.js.map